<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-159199190-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Dark Documentation" href="/opensearch.xml"><title data-react-helmet="true">Repository directory structure | Dark Documentation</title><meta data-react-helmet="true" property="og:image" content="https://docs.darklang.com/img/favicon.ico"><meta data-react-helmet="true" property="twitter:image" content="https://docs.darklang.com/img/favicon.ico"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Dark Documentation"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Repository directory structure | Dark Documentation"><meta data-react-helmet="true" name="description" content="The Dark repo contains multiple services and compilation targets. For OCaml, here&#x27;s how the various directories intersect, and what language they use:"><meta data-react-helmet="true" property="og:description" content="The Dark repo contains multiple services and compilation targets. For OCaml, here&#x27;s how the various directories intersect, and what language they use:"><meta data-react-helmet="true" property="og:url" content="https://docs.darklang.com/contributing/repo-layout"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.darklang.com/contributing/repo-layout"><link rel="stylesheet" href="/styles.f03e3bc4.css">
<link rel="preload" href="/styles.07077e44.js" as="script">
<link rel="preload" href="/runtime~main.91c4bbec.js" as="script">
<link rel="preload" href="/main.70223205.js" as="script">
<link rel="preload" href="/1.14df050a.js" as="script">
<link rel="preload" href="/2.b7a2668d.js" as="script">
<link rel="preload" href="/90.44038b43.js" as="script">
<link rel="preload" href="/91.fb068903.js" as="script">
<link rel="preload" href="/05c17924.1b0ba798.js" as="script">
<link rel="preload" href="/17896441.60fa8c2c.js" as="script">
<link rel="preload" href="/12ccec4b.9e47a461.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a href="https://darklang.com" target="_blank" rel="noopener noreferrer" class="navbar__brand" to="https://darklang.com"><img class="navbar__logo" src="/img/favicon.ico" alt="Dark logo"><strong class="navbar__title">Dark</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/introduction">Documentation</a><a class="navbar__item navbar__link" href="/tutorials/tutorial-intro">Tutorials &amp; Samples</a><a class="navbar__item navbar__link" href="/slack-apps/slack-intro">Building Slack Apps</a><a class="navbar__item navbar__link" href="/contributing/getting-started">Contributing</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><div class="searchWrapper_-F3-"><span aria-label="expand searchbar" role="button" class="searchIconButton_1Dnz" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_2eto"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a href="https://darklang.com" target="_blank" rel="noopener noreferrer" class="navbar__brand" to="https://darklang.com"><img class="navbar__logo" src="/img/favicon.ico" alt="Dark logo"><strong class="navbar__title">Dark</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/introduction">Documentation</a></li><li class="menu__list-item"><a class="menu__link" href="/tutorials/tutorial-intro">Tutorials &amp; Samples</a></li><li class="menu__list-item"><a class="menu__link" href="/slack-apps/slack-intro">Building Slack Apps</a></li><li class="menu__list-item"><a class="menu__link" href="/contributing/getting-started">Contributing</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp" role="complementary"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Your First Contribution</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contributing/getting-started">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contributing/setting-up-the-repo">Setting up the Dark repo</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contributing/adding-your-first-test">Adding your first test</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contributing/making-your-first-pull-request">Making your first Pull Request</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Your Next Contributions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contributing/next-contribution">Your next contribution</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contributing/if-you-dont-know-ocaml">If you don&#x27;t know OCaml</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contributing/adding-a-function">Adding a built-in function</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contributing/adding-a-language-feature">Adding a language feature</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contributing/adding-a-refactoring">Adding a refactoring</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Working in the Dark repo</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/contributing/ocaml-for-dark-developers">OCaml for Dark developers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/contributing/general-concepts">General concepts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/contributing/tour-of-editor">A tour of the Editor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/contributing/tour-of-backend">A tour of the Backend</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/contributing/repo-layout">Repository directory structure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/contributing/glossary">Glossary</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/contributing/debugging">Debugging</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/contributing/troubleshooting">Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/contributing/making-a-pull-request">Making a Pull Request</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Repository directory structure</h1></header><div class="markdown"><p>The Dark repo contains multiple services and compilation targets. For OCaml, here&#x27;s how the various directories intersect, and what language they use:</p><p><img src="assets/contributing/compilation-targets.png" alt="Compilation targets and their respective directories"></p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="directory-listing"></a>Directory listing<a aria-hidden="true" tabindex="-1" class="hash-link" href="#directory-listing" title="Direct link to heading">#</a></h1><ul><li><code>.circleci</code> - CI config file</li><li><code>auth0-branding</code> - has some assets for our login provider</li><li><code>_build</code> - build dir for OCaml (empty, this is a docker volume)</li><li><code>backend</code> - this is the main part of our backend, written in OCaml, including the language definition and execution engine, the &quot;framework&quot; (HTTP, DB, queues, etc), the editor&#x27;s HTTP API, and the execution engine which runs in the client (compiled to JS from OCaml)<ul><li><code>bin</code> - &quot;main&quot; files for executables</li><li><code>jsanalysis</code> - &quot;main&quot; file for client-side analysis/execution-engine</li><li><code>libbackend</code> - the main HTTP server, and framework functionality (HTTP, DB, queues)</li><li><code>libcommon</code> - some utilities shared between JS- and OCaml-compiled versions of backend</li><li><code>libexecution</code> - the Dark language, including types, the runtime, most of the standard library, and of course the execution engine</li><li><code>libservice</code> - library with some common functionality for OCaml services (backend, queues, cron)</li><li><code>libtarget</code> - library to support certain functions in native and JS modes. Interface only.</li><li><code>libtarget.js</code> - JS implementation of <code>libtarget</code></li><li><code>libtarget.ocaml</code> - OCaml implementation of <code>libtarget</code></li><li><code>libunshared</code> - platform specific (native) version of <code>libunshared</code>, which is used to provide types to <code>libshared</code></li><li><code>migrations</code> - SQL for migrations</li><li><code>node_modules</code> - installation dir for Esy (package manager-ish thing for OCaml)</li><li><code>serialization</code> - definition of a binary serialization format we use to store Dark programs</li><li><code>static</code> - static HTTP assets (icons, fonts, etc)</li><li><code>swagger</code> - deprecated old functionality</li><li><code>templates</code> - where the single editor HTML template is stored</li><li><code>test</code> - all backend unit tests</li><li><code>test_appdata</code> - serialized mocked data for integration tests</li></ul></li><li><code>client</code> - the editor, and the entire frontend application that is found under <a href="http://darklang.com/a/yourcanvas" target="_blank" rel="noopener noreferrer">darklang.com/a/yourcanvas</a> (note, not darklang.com or the docs). Written in Bucklescript/ReasonML. All frontend functionality, except the server-side APIs used for it, are here<ul><li><code>src/analysis</code> - handles code related to live values - requesting from the server, storing, sending to the client-side execution engine</li><li><code>src/api</code> - most requests to the HTTP API live here</li><li><code>src/app</code> - important scaffolding for the application (settings, exception tracking, <code>Main.ml</code>)</li><li><code>src/canvas</code> - misc files pertaining to layout</li><li><code>src/components</code> - a number of parts of Dark have been componentized. They live here.</li><li><code>src/core</code> - all the frontend types are defined here, also JSON encoders and decoders for them</li><li><code>src/fluid</code> - fluid is the &quot;editing&quot; portion of the editor, the thing you type code in. All editing of Dark code happens in here</li><li><code>src/forms</code> - the &quot;forms&quot; editor, used for editing any form-like boxes (HTTP handler headings, DB fields, etc). Still recovering from when it was also how we wrote Dark code</li><li><code>src/package</code> -the Dark package manager</li><li><code>src/prelude</code> - builtin functions that are available in most other files (which start with <code>open Prelude</code>)</li><li><code>src/toplevels</code> - HTTP handler, workers, REPLs, DBs, functions, etc, are all &quot;toplevels&quot;</li><li><code>src/util</code> - generic utility code</li><li><code>static</code> - some assets</li><li><code>styles</code> - CSS</li><li><code>test</code> - unit tests</li><li><code>workers</code> - web workers used for analysis and fetching data from the server in the background</li></ul></li><li><code>config</code> - a set of env vars for each environment. You&#x27;ll be interested in the <code>dev</code> environment</li><li><code>docs</code> - sporadic documentation</li><li><code>docs/production</code> - documentation about how we run the Dark service</li><li><code>integration-tests</code> - integration tests, written in JS using TestCafe. Flaky and brittle. Help welcome!</li><li><code>lib</code> - build directory used by Bucklescript</li><li><code>libshared</code> - a small set of types that are shared between the backend and client. New and in-progress.</li><li><code>node_modules</code> - installation dir for <code>npm</code></li><li><code>postgres-honeytail</code> - a backend service used to send Postgres logs to Honeycomb (our observability vendor). The only Go in our repo.</li><li><code>queue-scheduler</code> - a Rust backend service that runs our queues.</li><li><code>rundir</code> - anything that runs and stores something stores it here<ul><li><code>integration_test_logs</code></li><li><code>logs</code> - logs from running services, especially <code>server.log</code> (backend)</li><li><code>screenshots</code> - for integration tests</li><li><code>videos</code> - for integration tests</li></ul></li><li><code>stroller</code> - a Rust backend service that sits next to our OCaml backend. When the OCaml backend sends data to Pusher (websockets vendor) or Rollbar (exception tracking), it sends it to Stroller to send to the vendor instead. This allows execution to continue running immediately (our backend does not have efficient concurrency, so this is a hack to allow it)</li><li><code>scripts</code> - bash scripts to do common (and sometimes uncommon and therefore forgettable) actions on the repo. Using scripts is very very common.</li></ul></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/contributing/tour-of-backend"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« A tour of the Backend</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/contributing/glossary"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Glossary »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learning</h4><ul class="footer__items"><li class="footer__item"><a href="https://darklang.com/launch/demo-video" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://darklang.com/launch/demo-video">Demo Video</a></li><li class="footer__item"><a href="https://youtube.com/c/Darklang/videos" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://youtube.com/c/Darklang/videos">Tutorial Videos</a></li><li class="footer__item"><a href="https://darklang.com/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://darklang.com/docs">Docs</a></li><li class="footer__item"><a href="https://darklang.com/docs/tutorials" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://darklang.com/docs/tutorials">Tutorials &amp; Samples</a></li><li class="footer__item"><a href="https://darklang.com/docs/slack-apps" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://darklang.com/docs/slack-apps">Building Slack Apps</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">About</h4><ul class="footer__items"><li class="footer__item"><a href="https://darklang.com/about" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://darklang.com/about">Company</a></li><li class="footer__item"><a href="https://dev.to/darklang" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://dev.to/darklang">Dev Blog</a></li><li class="footer__item"><a href="https://medium.com/darklang" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://medium.com/darklang">Corp Blog</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://darklang.com/slack-invite" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://darklang.com/slack-invite">Community Slack</a></li><li class="footer__item"><a href="https://github.com/darklang/dark" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://github.com/darklang/dark">Dark Repo</a></li><li class="footer__item"><a href="https://github.com/darklang/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://github.com/darklang/docs">Docs Repo</a></li><li class="footer__item"><a class="footer__link-item" href="/contributing/getting-started">Contributor Docs</a></li><li class="footer__item"><a href="https://darklang.com/code-of-conduct" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://darklang.com/code-of-conduct">Code of Conduct</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Product</h4><ul class="footer__items"><li class="footer__item"><a href="https://darklang.com/login" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://darklang.com/login">Sign in</a></li><li class="footer__item"><a href="https://darklang.com/signup" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://darklang.com/signup">Sign up</a></li><li class="footer__item"><a href="https://darklang.com/desktop-client" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://darklang.com/desktop-client">Desktop Client</a></li><li class="footer__item"><a href="https://darklang.com/mailing-list" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://darklang.com/mailing-list">Mailing List</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 Dark Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.07077e44.js"></script>
<script src="/runtime~main.91c4bbec.js"></script>
<script src="/main.70223205.js"></script>
<script src="/1.14df050a.js"></script>
<script src="/2.b7a2668d.js"></script>
<script src="/90.44038b43.js"></script>
<script src="/91.fb068903.js"></script>
<script src="/05c17924.1b0ba798.js"></script>
<script src="/17896441.60fa8c2c.js"></script>
<script src="/12ccec4b.9e47a461.js"></script>
</body>
</html>