(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{215:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return o})),a.d(t,"metadata",(function(){return i})),a.d(t,"rightToc",(function(){return c})),a.d(t,"default",(function(){return p}));var n=a(2),l=a(11),r=(a(0),a(242)),o={id:"new-trello-card",title:"Create a New Trello Card from Slack",sidebar_label:"Create a New Trello Card"},i={id:"slack-apps/tutorials/new-trello-card",isDocsHomePage:!1,title:"Create a New Trello Card from Slack",description:"Connecting your Trello account with your Slack account can make for a powerful",source:"@site/docs/slack-apps/tutorials/new-trello-card.md",permalink:"/slack-apps/tutorials/new-trello-card",sidebar_label:"Create a New Trello Card",sidebar:"Slack",previous:{title:"Create Asana Projects & Tasks",permalink:"/slack-apps/tutorials/asana-tutorial"},next:{title:"Slack tutorial",permalink:"/slack-app-tutorial"}},c=[{value:"Trello Configuration",id:"trello-configuration",children:[]},{value:"Slack Configuration",id:"slack-configuration",children:[]},{value:"Building in Dark",id:"building-in-dark",children:[{value:"Handling Lists",id:"handling-lists",children:[]},{value:"Making input easier with modals",id:"making-input-easier-with-modals",children:[]}]}],s={rightToc:c};function p(e){var t=e.components,a=Object(l.a)(e,["components"]);return Object(r.b)("wrapper",Object(n.a)({},s,a,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"Connecting your Trello account with your Slack account can make for a powerful\ntool - no more switching tabs and hunting for the right Trello list when you\nwant to capture the excellent idea that just came up. In this tutorial, we'll\nshow you a few ways to enable your team to create new Trello cards directly from\nSlack."),Object(r.b)("h2",{id:"trello-configuration"},"Trello Configuration"),Object(r.b)("p",null,"For this tutorial, you're going to need to grab a few different things from\nTrello and store each of them as separate functions in Dark:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Your Trello API Key and Token,\n",Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://trello.com/app-key/"}),"available on this page")),Object(r.b)("li",{parentName:"ul"},"Your Trello org id, the id for one of your boards, and the id for one of your\nlists, which we will refer to as our ",Object(r.b)("inlineCode",{parentName:"li"},"defaultListID")," throughout the tutorial.\nThe best way to get all of these at once is to add ",Object(r.b)("inlineCode",{parentName:"li"},".json")," to the end of the\nURL on one of your boards, and search through the resulting JSON for the ",Object(r.b)("inlineCode",{parentName:"li"},"id"),"\nthat matches with the name of your board, the ",Object(r.b)("inlineCode",{parentName:"li"},"id")," that matches with the name\nof the list you'd like to use and ",Object(r.b)("inlineCode",{parentName:"li"},"idOrganization"),". Don't worry - we'll cover\nan easier way to handle this later in the tutorial.")),Object(r.b)("h2",{id:"slack-configuration"},"Slack Configuration"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://api.slack.com/apps"}),"Create a new app in Slack"),".")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Set a Slash command (the option should appear under ",Object(r.b)("strong",{parentName:"p"},"Add features &\nfunctionality")," on your app's main page). Your ",Object(r.b)("inlineCode",{parentName:"p"},"Request URL")," should look\nsomething like\n",Object(r.b)("inlineCode",{parentName:"p"},"https://yourusername-yourcanvasname.builtwithdark.com/new-trello-card"),". This\nis the URL that Slack will call when you use your slash command - don't add\nanything to your Dark canvas just yet. Also note our usage hint - a card name\nand card description, separated by a ",Object(r.b)("inlineCode",{parentName:"p"},"|")," symbol."))),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/slashcommand.png",alt:"slack-apps/tutorials/new-trello-card/slashcommand.png"}))),Object(r.b)("ol",{start:3},Object(r.b)("li",{parentName:"ol"},"Add the following scopes to your app: ",Object(r.b)("inlineCode",{parentName:"li"},"chat:write"),", ",Object(r.b)("inlineCode",{parentName:"li"},"chat:write.public"),",\n",Object(r.b)("inlineCode",{parentName:"li"},"commands"),".")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/scopes.png",alt:"slack-apps/tutorials/new-trello-card/scopes.png"}))),Object(r.b)("ol",{start:3},Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Install your app to the workspace (either via ",Object(r.b)("strong",{parentName:"p"},"Settings -> Basic\nInformation")," or ",Object(r.b)("strong",{parentName:"p"},"Settings -> Install App"),"). Since this app is being built\nfor your workspace specifically, we will not need to set up full OAuth, like\nwe would if we wanted to distribute this more publicly.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Copy your bot user access token, which will now be available under ",Object(r.b)("strong",{parentName:"p"},"Settings\n-> Install")," app and save it as a function in your Dark canvas. Use this\nfunction wherever you see ",Object(r.b)("inlineCode",{parentName:"p"},"slackToken")," in the code examples."))),Object(r.b)("h2",{id:"building-in-dark"},"Building in Dark"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Attempt to use your slash command. Make sure to include some text after your\nslash command, separated by a | symbol.")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/fullslashcommand.png",alt:"slack-apps/tutorials/new-trello-card/fullslashcommand.png"}))),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/httperror.png",alt:"slack-apps/tutorials/new-trello-card/httperror.png"}))),Object(r.b)("ol",{start:2},Object(r.b)("li",{parentName:"ol"},"Navigate to your Dark canvas and check the 404s section in the sidebar - you\nshould see an HTTP POST created called ",Object(r.b)("inlineCode",{parentName:"li"},"/new-trello-card")," (or whatever you\nused when setting up your slash command). Click the plus sign to add it to\nyour canvas.")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/404.png",alt:"slack-apps/tutorials/new-trello-card/404.png"}))),Object(r.b)("ol",{start:3},Object(r.b)("li",{parentName:"ol"},"Once it's on your canvas, you can place your carat over the trace on the left\n(the white dot) to see the incoming data Slack attempted to send.")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/trace.png",alt:"slack-apps/tutorials/new-trello-card/trace.png"}))),Object(r.b)("ol",{start:4},Object(r.b)("li",{parentName:"ol"},"In the body of your trace data, you will see a text field in the body. This\nis what we want to parse to get the name and description of the card we're\ngoing to create. In order to parse this information, we're going to use\n",Object(r.b)("inlineCode",{parentName:"li"},"String::split")," and parse on the special character ",Object(r.b)("inlineCode",{parentName:"li"},"|"),".")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/stringsplit.png",alt:"slack-apps/tutorials/new-trello-card/stringsplit.png"}))),Object(r.b)("ol",{start:5},Object(r.b)("li",{parentName:"ol"},"Now that we have a list of ",Object(r.b)("inlineCode",{parentName:"li"},"messageContent"),", we can use ",Object(r.b)("inlineCode",{parentName:"li"},"List::getAt")," to set\nthe name and description of the card.")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/listgetat.png",alt:"slack-apps/tutorials/new-trello-card/listgetat.png"}))),Object(r.b)("ol",{start:6},Object(r.b)("li",{parentName:"ol"},"Once we have all of the information we need, we can use the Dark package\nmanager ",Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"/packages#createNewCard"}),Object(r.b)("inlineCode",{parentName:"a"},"Trello::createNewCard")," function")," to\ncreate the new card. For simplicity's sake, we're going to use the\n",Object(r.b)("inlineCode",{parentName:"li"},"defaultListID")," we set earlier, as well as the ",Object(r.b)("inlineCode",{parentName:"li"},"trelloKey")," and ",Object(r.b)("inlineCode",{parentName:"li"},"trelloToken"),".")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/trellonewcard.png",alt:"slack-apps/tutorials/new-trello-card/trellonewcard.png"}))),Object(r.b)("ol",{start:7},Object(r.b)("li",{parentName:"ol"},"Re-run your HTTP handler, or call the slash command again and then check\nTrello - your new card will have been created in the list you specified.")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/newcard.png",alt:"slack-apps/tutorials/new-trello-card/newcard.png"}))),Object(r.b)("h3",{id:"handling-lists"},"Handling Lists"),Object(r.b)("p",null,"In the future, you probably won't want to worry about hunting around for your\nlist ids. We've made it easy for you to create your own lookup table to match\nlist names and ids."),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Create a ",Object(r.b)("inlineCode",{parentName:"li"},"Lists")," db.")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/listdb.png",alt:"slack-apps/tutorials/new-trello-card/listdb.png"}))),Object(r.b)("ol",{start:2},Object(r.b)("li",{parentName:"ol"},"Now, we can use built in Dark package manager functions to get a list of all\nof our Trello lists and add them to our DB. Create a REPL called\n",Object(r.b)("inlineCode",{parentName:"li"},"addListsToDB"),", add the following lines of code, and run it:")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/addliststodb.png",alt:"slack-apps/tutorials/new-trello-card/addliststodb.png"}))),Object(r.b)("ol",{start:3},Object(r.b)("li",{parentName:"ol"},"Let's try another slash command, this time with more information - specifying\nthe name of a list to add the card to.")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/slashcommandlist.png",alt:"slack-apps/tutorials/new-trello-card/slashcommandlist.png"}))),Object(r.b)("ol",{start:15},Object(r.b)("li",{parentName:"ol"},"Now ",Object(r.b)("inlineCode",{parentName:"li"},"messageContent")," will have a third entry in the list.")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/messagecontentwithlist.png",alt:"slack-apps/tutorials/new-trello-card/messagecontentwithlist.png"}))),Object(r.b)("ol",{start:16},Object(r.b)("li",{parentName:"ol"},"Using the built in\n",Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"/packages#lookuplistid"}),Object(r.b)("inlineCode",{parentName:"a"},"Trello:lookUpListID")," function"),", we can grab the\nname of that list and use it in our ",Object(r.b)("inlineCode",{parentName:"li"},"createNewCard")," function.")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/lookuplistid.png",alt:"slack-apps/tutorials/new-trello-card/lookuplistid.png"}))),Object(r.b)("h3",{id:"making-input-easier-with-modals"},"Making input easier with modals"),Object(r.b)("p",null,"Okay, this is all great, but still has some problems. What if someone forgets to\nadd the right special character? Let's make it a little easier, by creating a\nmodal to handle their input."),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Create a new slash command, just as we did at the beginning but with a\ndifferent name and Request URL. This allows us to build different\nfunctionality around this command without losing anything we did previously.\nI used ",Object(r.b)("inlineCode",{parentName:"p"},"/new-trello-card-modal"),".")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Turn Interactivity on via ",Object(r.b)("strong",{parentName:"p"},"Features -> Interactivity and Shortcuts")," and\nspecify a URL for the interaction to be sent to:"))),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/interactivity.png",alt:"slack-apps/tutorials/new-trello-card/interactivity.png"}))),Object(r.b)("ol",{start:3},Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Slack uses JSON to generate modals via a framework called Block Kit, even\nproviding a\n",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://api.slack.com/tools/block-kit-builder"}),"handy Block Kit builder"),". At\nthis point, it may make sense to pause and create your modal - we'll need the\nJSON soon. The modal we're going to use has 3 fields: a single line for the\ncard name, a multiline for the card description and a select for a list of\nlists.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Now, just like before, we're going to call the Slash command and grab\nthe 404."))),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/newslashcommand.png",alt:"slack-apps/tutorials/new-trello-card/newslashcommand.png"}))),Object(r.b)("ol",{start:5},Object(r.b)("li",{parentName:"ol"},"Grab your ",Object(r.b)("inlineCode",{parentName:"li"},"trigger_id")," from the ",Object(r.b)("inlineCode",{parentName:"li"},"request.body"),":")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/triggerid.png",alt:"slack-apps/tutorials/new-trello-card/triggerid.png"}))),Object(r.b)("ol",{start:6},Object(r.b)("li",{parentName:"ol"},"Create an ",Object(r.b)("inlineCode",{parentName:"li"},"HttpClient::post")," request and add your ",Object(r.b)("inlineCode",{parentName:"li"},"trigger_id")," and ",Object(r.b)("inlineCode",{parentName:"li"},"JSON"),".\nThese are truncated screenshots with a lot of the JSON cut out:")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/json1.png",alt:"slack-apps/tutorials/new-trello-card/json1.png"}))),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/json2.png",alt:"slack-apps/tutorials/new-trello-card/json2.png"}))),Object(r.b)("ol",{start:7},Object(r.b)("li",{parentName:"ol"},"Try your Slash command - a modal should open. Input text and try to send. You\nwill get an error message:")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/troubleconnecting.png",alt:"slack-apps/tutorials/new-trello-card/troubleconnecting.png"}))),Object(r.b)("ol",{start:8},Object(r.b)("li",{parentName:"ol"},"We need to work with our ",Object(r.b)("inlineCode",{parentName:"li"},"/interaction")," handler, which should be available in\nyour 404s. We're going to start with parsing the payload Slack sent through:")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/payload.png",alt:"slack-apps/tutorials/new-trello-card/payload.png"}))),Object(r.b)("ol",{start:9},Object(r.b)("li",{parentName:"ol"},"We can use that payload to grab the information that you submitted in your\nmodal:")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/submittedinfo.png",alt:"slack-apps/tutorials/new-trello-card/submittedinfo.png"}))),Object(r.b)("ol",{start:10},Object(r.b)("li",{parentName:"ol"},"And, just like before, we'll use the ",Object(r.b)("inlineCode",{parentName:"li"},"Trello::lookUpListID")," to find the\ncorrect Trello list:")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/lookuplistid2.png",alt:"slack-apps/tutorials/new-trello-card/lookuplistid2.png"}))),Object(r.b)("ol",{start:11},Object(r.b)("li",{parentName:"ol"},"All that's left is creating the new card and sending a 200 response back to\nSlack:")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/newcard200.png",alt:"slack-apps/tutorials/new-trello-card/newcard200.png"}))),Object(r.b)("ol",{start:12},Object(r.b)("li",{parentName:"ol"},"Try to create a ticket again with your Slash command:")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/lasttry.png",alt:"slack-apps/tutorials/new-trello-card/lasttry.png"}))),Object(r.b)("ol",{start:13},Object(r.b)("li",{parentName:"ol"},"Once you hit submit, your ticket will appear in Trello!")),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/new-trello-card/trelloticket.png",alt:"slack-apps/tutorials/new-trello-card/trelloticket.png"}))),Object(r.b)("p",null,"Congratulations, you now have a Slack app that can create Trello cards in\nmultiple ways!"))}p.isMDXComponent=!0},242:function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return m}));var n=a(0),l=a.n(n);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var s=l.a.createContext({}),p=function(e){var t=l.a.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},b=function(e){var t=p(e.components);return l.a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return l.a.createElement(l.a.Fragment,{},t)}},u=l.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,o=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),b=p(a),u=n,m=b["".concat(o,".").concat(u)]||b[u]||d[u]||r;return a?l.a.createElement(m,i(i({ref:t},s),{},{components:a})):l.a.createElement(m,i({ref:t},s))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,o=new Array(r);o[0]=u;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:n,o[1]=i;for(var s=2;s<r;s++)o[s]=a[s];return l.a.createElement.apply(null,o)}return l.a.createElement.apply(null,a)}u.displayName="MDXCreateElement"}}]);