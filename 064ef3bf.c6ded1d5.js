(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{152:function(a,t,e){"use strict";e.r(t),e.d(t,"frontMatter",(function(){return l})),e.d(t,"metadata",(function(){return s})),e.d(t,"rightToc",(function(){return i})),e.d(t,"default",(function(){return p}));var n=e(2),r=e(11),o=(e(0),e(242)),l={id:"asana-tutorial",title:"Create Asana Projects & Tasks",sidebar_label:"Create Asana Projects & Tasks"},s={id:"slack-apps/tutorials/asana-tutorial",isDocsHomePage:!1,title:"Create Asana Projects & Tasks",description:"Connecting your Asana account with your Slack account can make for a powerful",source:"@site/docs/slack-apps/tutorials/asana-tutorial.md",permalink:"/slack-apps/tutorials/asana-tutorial",sidebar_label:"Create Asana Projects & Tasks",sidebar:"Slack",previous:{title:"Check for New Channels",permalink:"/slack-apps/tutorials/channel-check"},next:{title:"Create a New Trello Card from Slack",permalink:"/slack-apps/tutorials/new-trello-card"}},i=[{value:"Asana Configuration",id:"asana-configuration",children:[]},{value:"Slack Configuration",id:"slack-configuration",children:[]},{value:"Building In Dark",id:"building-in-dark",children:[{value:"Looking Up Project &amp; Workspace IDs",id:"looking-up-project--workspace-ids",children:[]},{value:"Making input easier with modals",id:"making-input-easier-with-modals",children:[]}]}],c={rightToc:i};function p(a){var t=a.components,e=Object(r.a)(a,["components"]);return Object(o.b)("wrapper",Object(n.a)({},c,e,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"Connecting your Asana account with your Slack account can make for a powerful\ntool - no more switching tabs and hunting for the right Asana project when you\nwant to capture the excellent idea that just came up. In this tutorial, we'll\nshow you a few ways to enable your team to create new Asana tasks directly from\nSlack."),Object(o.b)("h2",{id:"asana-configuration"},"Asana Configuration"),Object(o.b)("p",null,"For this tutorial, you'll want to grab a couple different things from Asana and\nstore each of them as separate functions in Dark:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Your ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://app.asana.com/0/developer-console"}),"personal access token")),Object(o.b)("li",{parentName:"ul"},"The id of one of your workspaces. The easiest way to access this is via the\nadmin panel - it will be the long number in the URL.")),Object(o.b)("h2",{id:"slack-configuration"},"Slack Configuration"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://api.slack.com/apps"}),"Create a new app in Slack.")),Object(o.b)("li",{parentName:"ol"},"Set a Slash command (the option should appear under ",Object(o.b)("strong",{parentName:"li"},"Add features &\nfunctionality")," on your app's main page). Your Request URL should look\nsomething like\n",Object(o.b)("inlineCode",{parentName:"li"},"https://yourusername-yourcanvasname.builtwithdark.com/new-project"),". This is\nthe URL that Slack will call when you use your slash command - don't add\nanything to your Dark canvas just yet.")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/slashcommand.png",alt:"slack-apps/tutorials/asana-tutorial/slashcommand.png"}))),Object(o.b)("ol",{start:3},Object(o.b)("li",{parentName:"ol"},"Go to ",Object(o.b)("strong",{parentName:"li"},"Features -> OAuth & Permissions")," and add the following scopes to\nyour app: ",Object(o.b)("inlineCode",{parentName:"li"},"chat:write"),", ",Object(o.b)("inlineCode",{parentName:"li"},"chat:write.public"),", ",Object(o.b)("inlineCode",{parentName:"li"},"commands."))),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/permissions.png",alt:"slack-apps/tutorials/asana-tutorial/permissions.png"}))),Object(o.b)("ol",{start:4},Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Install your app to the workspace (either via\xa0",Object(o.b)("strong",{parentName:"p"},"Settings -> Basic\nInformation"),"\xa0or\xa0",Object(o.b)("strong",{parentName:"p"},"Settings -> Install App"),"). Since this app is being built\nfor your workspace specifically, we will not need to set up full OAuth, like\nwe would if we wanted to distribute this more publicly.")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Copy your bot user access token, which will now be available under\xa0",Object(o.b)("strong",{parentName:"p"},"Settings\n-> Install"),"\xa0app and save it as a function in your Dark canvas. Use this\nfunction wherever you see\xa0",Object(o.b)("inlineCode",{parentName:"p"},"slackToken"),"\xa0in the code examples."))),Object(o.b)("h2",{id:"building-in-dark"},"Building In Dark"),Object(o.b)("p",null,"First, we're going to learn how to create new Asana projects using slash\ncommands."),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Go to Slack and try to use your new slash command. Make sure to include some\ntext after entering your command. You will see an error message appear.")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/newprojecterror.png",alt:"slack-apps/tutorials/asana-tutorial/newprojecterror.png"}))),Object(o.b)("ol",{start:2},Object(o.b)("li",{parentName:"ol"},"Navigate to your Dark canvas and check the 404s section in the sidebar - you\nshould see an HTTP POST created called ",Object(o.b)("inlineCode",{parentName:"li"},"/new-project")," (or whatever you used\nwhen setting up your slash command). Click the plus sign to add it to your\ncanvas.")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/newproject404.png",alt:"slack-apps/tutorials/asana-tutorial/newproject404.png"}))),Object(o.b)("ol",{start:3},Object(o.b)("li",{parentName:"ol"},"Once your handler is on your canvas, you can click on the trace (the white\ndot to the left) to see the incoming data Slack attempted to send.")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/trace.png",alt:"slack-apps/tutorials/asana-tutorial/trace.png"}))),Object(o.b)("ol",{start:4},Object(o.b)("li",{parentName:"ol"},"You will see a text field in the body of the trace data. Use\n",Object(o.b)("inlineCode",{parentName:"li"},"request.body.text")," to set your project name.")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/projectname.png",alt:"slack-apps/tutorials/asana-tutorial/projectname.png"}))),Object(o.b)("ol",{start:5},Object(o.b)("li",{parentName:"ol"},"Using the ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"/packages#createproject"}),Object(o.b)("inlineCode",{parentName:"a"},"Asana::createProject function")),"\nand the data we grabbed from the trace, we can now create a new project. You\nwill need to use the workspace id and personal access token you saved in the\nset-up process.")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/createProject.png",alt:"slack-apps/tutorials/asana-tutorial/createProject.png"}))),Object(o.b)("ol",{start:6},Object(o.b)("li",{parentName:"ol"},"Try your Slash command again and then check Asana - your new project will be\nthere!")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/asanaproject.png",alt:"slack-apps/tutorials/asana-tutorial/asanaproject.png"}))),Object(o.b)("ol",{start:7},Object(o.b)("li",{parentName:"ol"},"Now, let's try sending over a slash command with different data. Return to\nSlack and use your slash command again, but this time, write a project name,\n",Object(o.b)("inlineCode",{parentName:"li"},"\\")," sign and a description and send it over (something like\n",Object(o.b)("inlineCode",{parentName:"li"},"\\asana-new-project Another New Project/Notes on the project"),"). Return to\nDark and check the traces - you should see a text field formatted like this:")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/textexample.png",alt:"slack-apps/tutorials/asana-tutorial/textexample.png"}))),Object(o.b)("ol",{start:8},Object(o.b)("li",{parentName:"ol"},"Now, we can use the ",Object(o.b)("inlineCode",{parentName:"li"},"String::split")," function to separate out our two pieces\nof information, and add them separately to the\n",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"....%5Cpackages.md#createProject"}),Object(o.b)("inlineCode",{parentName:"a"},"Asana::createProject function"))," function.")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/notes.png",alt:"slack-apps/tutorials/asana-tutorial/notes.png"}))),Object(o.b)("h3",{id:"looking-up-project--workspace-ids"},"Looking Up Project & Workspace IDs"),Object(o.b)("p",null,"You're not always going to want to pre-define your workspace or projects via\nDark functions. This section will show you how to take a project name as a\n",Object(o.b)("inlineCode",{parentName:"p"},"String")," and get the corresponding id. We'll be using projects for this example,\nbut it works the same way for workspaces."),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Create a Projects datastore.")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/projectsdatastore.png",alt:"slack-apps/tutorials/asana-tutorial/projectsdatastore.png"}))),Object(o.b)("ol",{start:2},Object(o.b)("li",{parentName:"ol"},"Create a new REPL. First, use the\n",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"....%5Cpackages.md#getAllProjects"}),Object(o.b)("inlineCode",{parentName:"a"},"Asana::getAllProjects"))," function to grab\ninformation about all projects you have access to. Then, use a ",Object(o.b)("inlineCode",{parentName:"li"},"List::map")," to\nadd their names and gids to the DB.")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/populatedb.png",alt:"slack-apps/tutorials/asana-tutorial/populatedb.png"}))),Object(o.b)("ol",{start:3},Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"To see this in action, create a fresh slash command and call it, using the\ntask name/project name formatting. To make it easier on yourself, make sure\nto use a project name that already exists.")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Split out the information as you did before."))),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/taskandproject.png",alt:"slack-apps/tutorials/asana-tutorial/taskandproject.png"}))),Object(o.b)("ol",{start:5},Object(o.b)("li",{parentName:"ol"},"Create a new function called ",Object(o.b)("inlineCode",{parentName:"li"},"lookUpProjectID")," and then use ",Object(o.b)("inlineCode",{parentName:"li"},"DB::queryOne")," to\ngrab the id based on the ",Object(o.b)("inlineCode",{parentName:"li"},"projectName"),".")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/lookupprojectid.png",alt:"slack-apps/tutorials/asana-tutorial/lookupprojectid.png"}))),Object(o.b)("ol",{start:6},Object(o.b)("li",{parentName:"ol"},"Use a match statement to handle both the success and failure (couldn't find\nthe project name in the db) case.")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/match.png",alt:"slack-apps/tutorials/asana-tutorial/match.png"}))),Object(o.b)("ol",{start:7},Object(o.b)("li",{parentName:"ol"},"Use your new function your HTTP POST handler.")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/lookupid.png",alt:"slack-apps/tutorials/asana-tutorial/lookupid.png"}))),Object(o.b)("ol",{start:8},Object(o.b)("li",{parentName:"ol"},"Call the slash command again and check Asana - a new task should be there.")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/newesttask.png",alt:"slack-apps/tutorials/asana-tutorial/newesttask.png"}))),Object(o.b)("h3",{id:"making-input-easier-with-modals"},"Making input easier with modals"),Object(o.b)("p",null,"Okay, this is all great, but still has some problems. What if someone forgets to\nadd the right special character? Let's make it a little easier, by creating a\nmodal to handle their input."),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Create a new slash command.")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/newmodal.png",alt:"slack-apps/tutorials/asana-tutorial/newmodal.png"}))),Object(o.b)("ol",{start:2},Object(o.b)("li",{parentName:"ol"},"Turn Interactivity on via ",Object(o.b)("strong",{parentName:"li"},"Features -> Interactivity and Shortcuts")," and\nspecify a URL for the interaction to be sent to:")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/interactivity.png",alt:"slack-apps/tutorials/asana-tutorial/interactivity.png"}))),Object(o.b)("ol",{start:3},Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Slack uses ",Object(o.b)("inlineCode",{parentName:"p"},"JSON")," to generate modals via a framework called Block Kit, even\nproviding a\n",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://api.slack.com/tools/block-kit-builder"}),"handy Block Kit builder"),". At\nthis point, it may make sense to pause and create your modal - we'll need the\n",Object(o.b)("inlineCode",{parentName:"p"},"JSON")," soon. The modal we're going to use has 3 fields: a single line for the\ntask name, a multiline for the task description and a select for a list of\nprojects.")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Call your new slash command and grab the 404, as you did in previous steps.")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Start by setting your ",Object(o.b)("inlineCode",{parentName:"p"},"triggerId")," using ",Object(o.b)("inlineCode",{parentName:"p"},"request.body.trigger_id"),":"))),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/triggerid.png",alt:"slack-apps/tutorials/asana-tutorial/triggerid.png"}))),Object(o.b)("ol",{start:6},Object(o.b)("li",{parentName:"ol"},"Format your header - you will need the Slack token you grabbed earlier in the\nset-up process.")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/header.png",alt:"slack-apps/tutorials/asana-tutorial/header.png"}))),Object(o.b)("ol",{start:7},Object(o.b)("li",{parentName:"ol"},"Create an ",Object(o.b)("inlineCode",{parentName:"li"},"HttpClient::post")," request and add your ",Object(o.b)("inlineCode",{parentName:"li"},"triggerID")," and ",Object(o.b)("inlineCode",{parentName:"li"},"JSON"),".\nThese are truncated screenshots with a lot of the JSON cut out:")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/json1.png",alt:"slack-apps/tutorials/asana-tutorial/json1.png"}))),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/json2.png",alt:"slack-apps/tutorials/asana-tutorial/json2.png"}))),Object(o.b)("ol",{start:8},Object(o.b)("li",{parentName:"ol"},"Try your new Slash command. A modal should appear. Fill in the modal and hit\nsubmit to get a new error message:")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/asanaerror.png",alt:"slack-apps/tutorials/asana-tutorial/asanaerror.png"}))),Object(o.b)("ol",{start:8},Object(o.b)("li",{parentName:"ol"},"Check your 404s and add your new handler. This is the handler where the\nbehind-the-scenes logic will happen. Start by formatting the payload into\n",Object(o.b)("inlineCode",{parentName:"li"},"JSON"),".")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/payload.png",alt:"slack-apps/tutorials/asana-tutorial/payload.png"}))),Object(o.b)("ol",{start:9},Object(o.b)("li",{parentName:"ol"},"Now grab all of your important values from your modal fields:")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/payloaddata.png",alt:"slack-apps/tutorials/asana-tutorial/payloaddata.png"}))),Object(o.b)("ol",{start:10},Object(o.b)("li",{parentName:"ol"},"Use the ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"/packages#createTask"}),Object(o.b)("inlineCode",{parentName:"a"},"Asana::createTask"))," and the\n",Object(o.b)("inlineCode",{parentName:"li"},"lookUpProjectID")," functions to create your new task.")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/createtask.png",alt:"slack-apps/tutorials/asana-tutorial/createtask.png"}))),Object(o.b)("ol",{start:11},Object(o.b)("li",{parentName:"ol"},"Respond with a ",Object(o.b)("inlineCode",{parentName:"li"},"200"),".")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/200.png",alt:"slack-apps/tutorials/asana-tutorial/200.png"}))),Object(o.b)("ol",{start:12},Object(o.b)("li",{parentName:"ol"},"Check Asana - your new task should be visible in the project your specified\nproject.")),Object(o.b)("p",null,Object(o.b)("img",Object(n.a)({parentName:"p"},{src:"/img/slack-apps/tutorials/asana-tutorial/mytask.png",alt:"slack-apps/tutorials/asana-tutorial/mytask.png"}))),Object(o.b)("p",null,"Congratulations, you now have a Slack app that can create Asana projects and\ntasks in multiple ways!"))}p.isMDXComponent=!0},242:function(a,t,e){"use strict";e.d(t,"a",(function(){return b})),e.d(t,"b",(function(){return j}));var n=e(0),r=e.n(n);function o(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}function l(a,t){var e=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),e.push.apply(e,n)}return e}function s(a){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?l(Object(e),!0).forEach((function(t){o(a,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(e)):l(Object(e)).forEach((function(t){Object.defineProperty(a,t,Object.getOwnPropertyDescriptor(e,t))}))}return a}function i(a,t){if(null==a)return{};var e,n,r=function(a,t){if(null==a)return{};var e,n,r={},o=Object.keys(a);for(n=0;n<o.length;n++)e=o[n],t.indexOf(e)>=0||(r[e]=a[e]);return r}(a,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(a);for(n=0;n<o.length;n++)e=o[n],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(a,e)&&(r[e]=a[e])}return r}var c=r.a.createContext({}),p=function(a){var t=r.a.useContext(c),e=t;return a&&(e="function"==typeof a?a(t):s(s({},t),a)),e},b=function(a){var t=p(a.components);return r.a.createElement(c.Provider,{value:t},a.children)},u={inlineCode:"code",wrapper:function(a){var t=a.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(a,t){var e=a.components,n=a.mdxType,o=a.originalType,l=a.parentName,c=i(a,["components","mdxType","originalType","parentName"]),b=p(e),m=n,j=b["".concat(l,".").concat(m)]||b[m]||u[m]||o;return e?r.a.createElement(j,s(s({ref:t},c),{},{components:e})):r.a.createElement(j,s({ref:t},c))}));function j(a,t){var e=arguments,n=t&&t.mdxType;if("string"==typeof a||n){var o=e.length,l=new Array(o);l[0]=m;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=a,s.mdxType="string"==typeof a?a:n,l[1]=s;for(var c=2;c<o;c++)l[c]=e[c];return r.a.createElement.apply(null,l)}return r.a.createElement.apply(null,e)}m.displayName="MDXCreateElement"}}]);