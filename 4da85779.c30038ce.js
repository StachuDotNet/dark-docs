(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{181:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return u}));var i=n(2),a=n(11),r=(n(0),n(241)),o={title:"A tour of the Editor"},l={id:"contributing/tour-of-editor",isDocsHomePage:!1,title:"A tour of the Editor",description:"The editor is in client/. We refer to it as the client or the editor (we don't call it the frontend though).",source:"@site/docs/contributing/tour-of-editor.md",permalink:"/contributing/tour-of-editor",sidebar:"Contributing",previous:{title:"General concepts",permalink:"/contributing/general-concepts"},next:{title:"A tour of the Backend",permalink:"/contributing/tour-of-backend"}},c=[{value:"Elm architecture",id:"elm-architecture",children:[{value:"The fluid editor",id:"the-fluid-editor",children:[]},{value:"Command palette",id:"command-palette",children:[]},{value:"Autocomplete",id:"autocomplete",children:[]},{value:"&quot;Forms&quot; editor",id:"forms-editor",children:[]},{value:"Analysis",id:"analysis",children:[]},{value:"Ops",id:"ops",children:[]},{value:"An API call, end-to-end",id:"an-api-call-end-to-end",children:[]}]}],d={rightToc:c};function u(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(r.b)("wrapper",Object(i.a)({},d,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"The editor is in ",Object(r.b)("inlineCode",{parentName:"p"},"client/"),". We refer to it as the client or the editor (we don't call it the frontend though)."),Object(r.b)("p",null,"It started life as an Elm application, and still\nuses the Elm Architecture (which we like). The current app is in Bucklescript."),Object(r.b)("h2",{id:"elm-architecture"},"Elm architecture"),Object(r.b)("p",null,"The Elm architecture is a simple render loop, very similar to React (and especially redux):"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"the entire application state is a single value called ",Object(r.b)("inlineCode",{parentName:"li"},"model")),Object(r.b)("li",{parentName:"ul"},"each user action creates a ",Object(r.b)("inlineCode",{parentName:"li"},"Msg"),", which is passed to ",Object(r.b)("inlineCode",{parentName:"li"},"Main.update")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Main.update")," produces a new ",Object(r.b)("inlineCode",{parentName:"li"},"model"),", as well as some ",Object(r.b)("inlineCode",{parentName:"li"},"Cmd"),", which are interactions with the outside world."),Object(r.b)("li",{parentName:"ul"},"Executing the ",Object(r.b)("inlineCode",{parentName:"li"},"Cmd")," may introduce other ",Object(r.b)("inlineCode",{parentName:"li"},"Msg"),"s, such as a ",Object(r.b)("inlineCode",{parentName:"li"},"Cmd")," which makes an API call - the API response would be handled using a ",Object(r.b)("inlineCode",{parentName:"li"},"Msg"),"."),Object(r.b)("li",{parentName:"ul"},"Regularly, the ",Object(r.b)("inlineCode",{parentName:"li"},"Main.view")," command is called to generate HTML. The HTML uses a Virtual DOM, like Elm and React do, and diffs the new Virtual DOM against the old one, applying the diffs to the real DOM.")),Object(r.b)("p",null,"TODO: give an example of a lifecycle here"),Object(r.b)("p",null,"The implications are interesting:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"all changes are functional - there are no changes to the model except through the update,"),Object(r.b)("li",{parentName:"ul"},"no callbacks - every event generates a message, which makes an orderly update,"),Object(r.b)("li",{parentName:"ul"},"static typing - you are pretty much forced to handle all the events you create.")),Object(r.b)("p",null,"There are also some downsides:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"components aren't as neat as in React; often a change is spread across the application. Single changes often require changing 6 different files"),Object(r.b)("li",{parentName:"ul"},"when you need something outside these bounds, it can be quite challenging to find out how to do it"),Object(r.b)("li",{parentName:"ul"},"does not always play well with traditional JS libraries (however, for an app like ours which is often quite custom, this isn't that big a deal)")),Object(r.b)("p",null,"This is how Elm architectures typically work. Our app mostly works like this, but there are some exceptions:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Main.update")," delegates most of the work to ",Object(r.b)("inlineCode",{parentName:"li"},"Main.update'"),". ",Object(r.b)("inlineCode",{parentName:"li"},"Main.update'")," produces a ",Object(r.b)("inlineCode",{parentName:"li"},"Modification")," instead of a ",Object(r.b)("inlineCode",{parentName:"li"},"(Model, Cmd)"),", and a modification then produces the ",Object(r.b)("inlineCode",{parentName:"li"},"(Model, Cmd)")," pair you expect."),Object(r.b)("li",{parentName:"ul"},"we do sometimes directly read from the DOM or other global state (like the random number generator or the History API)")),Object(r.b)("p",null,"And there are some downsides to our app as well:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Main.ml")," is a mess"),Object(r.b)("li",{parentName:"ul"},"modifications were a bad idea"),Object(r.b)("li",{parentName:"ul"},"a single change can be spread far across the codebase")),Object(r.b)("p",null,"Fortunately, we have started componentizing a little bit, and this has helped. The Fluid codebase (actually editing the UI) for example is quite separated from unrelated code."),Object(r.b)("h3",{id:"the-fluid-editor"},"The fluid editor"),Object(r.b)("p",null,'Whenever you type code, you are using the "fluid" editor. This is a structured editor that is designed to feel like text when typing.'),Object(r.b)("p",null,"A structured editor is means that you cannot write invalid code. The editor edits the AST of the program"),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"More coming soon")),Object(r.b)("h3",{id:"command-palette"},"Command palette"),Object(r.b)("h3",{id:"autocomplete"},"Autocomplete"),Object(r.b)("h3",{id:"forms-editor"},'"Forms" editor'),Object(r.b)("h3",{id:"analysis"},"Analysis"),Object(r.b)("h3",{id:"ops"},"Ops"),Object(r.b)("h3",{id:"an-api-call-end-to-end"},"An API call, end-to-end"))}u.isMDXComponent=!0},241:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return m}));var i=n(0),a=n.n(i);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var d=a.a.createContext({}),u=function(e){var t=a.a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},s=function(e){var t=u(e.components);return a.a.createElement(d.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},b=a.a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,o=e.parentName,d=c(e,["components","mdxType","originalType","parentName"]),s=u(n),b=i,m=s["".concat(o,".").concat(b)]||s[b]||p[b]||r;return n?a.a.createElement(m,l(l({ref:t},d),{},{components:n})):a.a.createElement(m,l({ref:t},d))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=b;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var d=2;d<r;d++)o[d]=n[d];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"}}]);